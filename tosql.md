# Перенос базы программы ВЭД-Склад из Pardox в SQL-Server

### Установка и настройка SQL Server

1. Установка SQL Server описана в другой инструкции. Для удобства кроме самого SQL Server рекомендуется установить Management Studio, открыть в портя 1433 и т.д.
2. Создать базу с именем sts2021. 

### Настройка рабочего места 
1. Создать ODBC DSN для драйвера "SQL Server". (Панель управления - Администрирование - Источник данных(ODBC)-Добавить)
 - Задать имя - произвольное название, к примеру sts, и имя SQL сервера. сервер - может быть вида  <название компьютера>\<имя экземпляра> или <название компьютера>   (например 192.168.1.2\sqlexpress )
- Задать тип аутентификации SQL Server. Задать имя пользователя и пароль.
-Все остальные параметры оставить по умолчанию.

2. Выполнить преобразование базы данных(В ВЭД-Склад меню Сервис-База Данных-Преобразование базы данных)

  - В строке «База данных (Paradox)» указывается путь к БД программы ВЭД-Склад. По умолчанию предлагается путь текущей БД, т.е. той, на которую настроена программа (поддиректория DATA каталога установки программы).
  - В строке «Тип СУБД» из выпадающего списка необходимо выбрать формат БД, в которую Вы хотите выполнить преобразование, в нашем случае SQL server.
  - В строке «Имя БД» указать имя базы данных (STS2011), в строке «Сервер» указать имя  созданного DSN (sts), «Пользователь» и «Пароль» заданные в пункте 2.2 пользователь и пароль.

3. В настройках программы(Сервис-Настройка-База данных) указать драйвер "SQL Server" и в поле Сервер указать имя созданного DSN, нажать "Дополнительно". В "База данных" - sts2021, пользователь и пароль, как в пункте 1

5. Добавить в sts.ini в секцию [Database] параметр FreezeCalcFields=0 
Это позволит включить вычисляемые поля (для серверов БД).

6. Сортировка при работе с серверными СУБД отключена.

Можно установить нужное выражение сортировки в настройке, а затем выполнить прилагаемый скрипт [resortin.prd](resortin.prd) через Обработку документов-Произвольная...

Т.к. сортировка отключена, все новые документы и измененные документы будут находиться вверху книги учета, для более-менее нормального вида книги и сохранения сортированного порядка "от новых документам к старым" в книге учета, попробуйте изменить выражение сортировки в книге учета, в меню настройка-книга учета-выражение сортировки укажите

FDT('YYYYMMDD', KRD_MAIN.BD_DATE)+LEFTPAD(KRD_MAIN.STORE_DOC_NO, 30, " ").

### Перенос журналов

 ![alt Перенос журналов](jr.png)